(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[10],{"0Axr":function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return x})),r.d(t,"b",(function(){return y})),r.d(t,"c",(function(){return E})),r.d(t,"d",(function(){return O})),r.d(t,"e",(function(){return m})),r.d(t,"f",(function(){return b}));var n=r("ldnW"),a=r("mXOV"),i=r("WdoV"),o=r("Z+TT"),s=r("DtAh"),c=r("ci/Y"),u=r("Edxu"),p=r.n(u),f=r("mVOl"),l=r("zH4t"),h=r("16y9"),d=r("k73v");function b(e,t,r,n,a,i){return g.apply(this,arguments)}function g(){return(g=Object(n.a)(a.a.mark((function e(t,r,n,i,o,s){var c,u,p,h;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===i&&(i="application/octet-stream"),void 0===o&&(o=!0),f.a.debug("uploadToGaiaHub: uploading "+t+" to "+n.server),c={"Content-Type":i,Authorization:"bearer "+n.token},o?c["If-None-Match"]="*":s&&(c["If-Match"]=s),e.next=7,Object(l.a)(n.server+"/store/"+n.address+"/"+t,{method:"POST",headers:c,body:r});case 7:if((u=e.sent).ok){e.next=12;break}return e.next=11,E(u,"Error when uploading to Gaia hub.",n);case 11:throw e.sent;case 12:return e.next=14,u.text();case 14:return p=e.sent,h=JSON.parse(p),e.abrupt("return",h);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(e,t){return v.apply(this,arguments)}function v(){return(v=Object(n.a)(a.a.mark((function e(t,r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.a.debug("deleteFromGaiaHub: deleting "+t+" from "+r.server),e.next=3,Object(l.a)(r.server+"/delete/"+r.address+"/"+t,{method:"DELETE",headers:{Authorization:"bearer "+r.token}});case 3:if((n=e.sent).ok){e.next=8;break}return e.next=7,E(n,"Error deleting file from Gaia hub.",r);case 7:throw e.sent;case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(e,t){return Promise.resolve(""+t.url_prefix+t.address+"/"+e)}function w(t,r,n,a){var u=t.challenge_text,f=t.latest_auth_version&&parseInt(t.latest_auth_version.slice(1),10)>=1,l=Object(s.b)(r);if(!f)return function(t,r){var n;try{n=JSON.parse(t)}catch(l){throw new Error("Failed in parsing legacy challenge text from the gaia hub.")}if("gaiahub"===n[0]&&"blockstack_storage_please_sign"===n[3]){var a=Object(s.c)(r+(64===r.length?"01":"")),o=Object(c.a)(e.from(t)),u=a.sign(o),p=i.script.signature.encode(u,i.Transaction.SIGHASH_NONE).toString("hex").slice(0,-2),f=Object(s.b)(r);return e.from(JSON.stringify({publickey:f,signature:p})).toString("base64")}throw new Error("Failed to connect to legacy gaia hub. If you operate this hub, please update.")}(u,r);var h={gaiaChallenge:u,hubUrl:n,iss:l,salt:p()(16).toString("hex"),associationToken:a};return"v1:"+new o.TokenSigner("ES256K",r).sign(h)}function x(e,t,r){return k.apply(this,arguments)}function k(){return(k=Object(n.a)(a.a.mark((function e(t,r,n){var i,o,c,u,p;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.a.debug("connectToGaiaHub: "+t+"/hub_info"),e.next=3,Object(l.a)(t+"/hub_info");case 3:return i=e.sent,e.next=6,i.json();case 6:return o=e.sent,c=o.read_url_prefix,u=w(o,r,t,n),p=Object(s.a)(Object(s.c)(r+(64===r.length?"01":""))),e.abrupt("return",{url_prefix:c,max_file_upload_size_megabytes:o.max_file_upload_size_megabytes,address:p,token:u,server:t});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function O(e,t){return j.apply(this,arguments)}function j(){return(j=Object(n.a)(a.a.mark((function t(r,n){var o,c,u,p,f,h,d;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=i.ECPair.fromPrivateKey(e.from(n,"hex")),t.next=3,Object(l.a)(r+"/hub_info");case 3:return c=t.sent,t.next=6,c.text();case 6:return u=t.sent,p=JSON.parse(u),f=p.read_url_prefix,h=Object(s.a)(o),d=""+f+h+"/",t.abrupt("return",d);case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function S(e){return L.apply(this,arguments)}function L(){return(L=Object(n.a)(a.a.mark((function e(t){var r,n,i,o,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="",e.prev=1,e.next=4,t.text();case 4:r=e.sent;try{n=JSON.parse(r)}catch(a){}e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),f.a.debug("Error getting bad http response text: "+e.t0);case 11:return i=t.status,o=t.statusText,s=n||r,e.abrupt("return",{status:i,statusText:o,body:s});case 15:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}function E(e,t,r){return F.apply(this,arguments)}function F(){return(F=Object(n.a)(a.a.mark((function e(t,r,n){var i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.ok){e.next=2;break}throw new Error("Cannot get a BlockstackError from a valid response.");case 2:return e.next=4,S(t);case 4:if(401!==(i=e.sent).status){e.next=9;break}return e.abrupt("return",new h.n(r,i));case 9:if(402!==i.status){e.next=13;break}return e.abrupt("return",new h.j(r,i));case 13:if(403!==i.status){e.next=17;break}return e.abrupt("return",new h.a(r,i));case 17:if(404!==i.status){e.next=21;break}throw new h.c(r,i);case 21:if(409!==i.status){e.next=25;break}return e.abrupt("return",new h.b(r,i));case 25:if(412!==i.status){e.next=29;break}return e.abrupt("return",new h.l(r,i));case 29:if(413!==i.status){e.next=34;break}return o=n?Object(d.f)(n.max_file_upload_size_megabytes):0,e.abrupt("return",new h.k(r,i,o));case 34:return e.abrupt("return",new Error(r));case 35:case"end":return e.stop()}}),e)})))).apply(this,arguments)}}).call(this,r("tjlA").Buffer)},"4jIJ":function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r("ldnW"),a=r("mXOV"),i=r("DtAh"),o=r("9ym6"),s=r("k73v"),c=r("zH4t"),u=r("16y9"),p=r("49n0"),f=r("0Axr"),l=r("ghzz");var h=r("mVOl"),d=r("EHS+");function b(e,t){var r;return t.proof&&t.proof.url&&(r=t.proof.url),{"@type":"Account",service:e,identifier:t.username,proofType:"http",proofUrl:r}}var g=r("y3d+");var y=r("Dn1P"),v={type:"object",properties:{"@context":{type:"string",optional:!0},"@type":{type:"string"}}},m=function(e){var t,r;function n(t){var r;return void 0===t&&(t={}),(r=e.call(this,t)||this)._profile=Object.assign({},{"@type":"Person"},r._profile),r}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,n.validateSchema=function(e,t){return Object(y.validate)(v,e)},n.fromToken=function(e,t){return void 0===t&&(t=null),new n(Object(d.a)(e,t))},n.fromLegacyFormat=function(e){return new n(function(e){var t={"@type":"Person"};if(e){e.name&&e.name.formatted&&(t.name=e.name.formatted),e.bio&&(t.description=e.bio),e.location&&e.location.formatted&&(t.address={"@type":"PostalAddress",addressLocality:e.location.formatted});var r=[];e.avatar&&e.avatar.url&&r.push({"@type":"ImageObject",name:"avatar",contentUrl:e.avatar.url}),e.cover&&e.cover.url&&r.push({"@type":"ImageObject",name:"cover",contentUrl:e.cover.url}),r.length&&(t.image=r),e.website&&(t.website=[{"@type":"WebSite",url:e.website}]);var n=[];e.bitcoin&&e.bitcoin.address&&n.push({"@type":"Account",role:"payment",service:"bitcoin",identifier:e.bitcoin.address}),e.twitter&&e.twitter.username&&n.push(b("twitter",e.twitter)),e.facebook&&e.facebook.username&&n.push(b("facebook",e.facebook)),e.github&&e.github.username&&n.push(b("github",e.github)),e.auth&&e.auth.length>0&&e.auth[0]&&e.auth[0].publicKeychain&&n.push({"@type":"Account",role:"key",service:"bip32",identifier:e.auth[0].publicKeychain}),e.pgp&&e.pgp.url&&n.push({"@type":"Account",role:"key",service:"pgp",identifier:e.pgp.fingerprint,contentUrl:e.pgp.url}),t.account=n}return t}(e))};var a=n.prototype;return a.toJSON=function(){return{profile:this.profile(),name:this.name(),givenName:this.givenName(),familyName:this.familyName(),description:this.description(),avatarUrl:this.avatarUrl(),verifiedAccounts:this.verifiedAccounts(),address:this.address(),birthDate:this.birthDate(),connections:this.connections(),organizations:this.organizations()}},a.profile=function(){return Object.assign({},this._profile)},a.name=function(){return function(e){if(!e)return null;var t=null;return e.name?t=e.name:(e.givenName||e.familyName)&&(t="",e.givenName&&(t=e.givenName),e.familyName&&(t+=" "+e.familyName)),t}(this.profile())},a.givenName=function(){return function(e){if(!e)return null;var t=null;e.givenName?t=e.givenName:e.name&&(t=e.name.split(" ").slice(0,-1).join(" "));return t}(this.profile())},a.familyName=function(){return function(e){if(!e)return null;var t=null;e.familyName?t=e.familyName:e.name&&(t=e.name.split(" ").pop());return t}(this.profile())},a.description=function(){return function(e){if(!e)return null;var t=null;return e.description&&(t=e.description),t}(this.profile())},a.avatarUrl=function(){return function(e){if(!e)return null;var t=null;return e.image&&e.image.map((function(e){return"avatar"===e.name?t=e.contentUrl:null})),t}(this.profile())},a.verifiedAccounts=function(e){return function(e,t){if(!e)return null;var r=[];return e.hasOwnProperty("account")&&t&&e.account.map((function(e){var n=!1,a=null;return t.map((function(t){return t.hasOwnProperty("proof_url")&&(t.proofUrl=t.proof_url),!(!t.valid||t.service!==e.service||t.identifier!==e.identifier||!t.proofUrl)&&(n=!0,a=t.proofUrl,!0)})),n?(e.proofUrl=a,r.push(e),e):null})),r}(this.profile(),e)},a.address=function(){return function(e){if(!e)return null;var t=null;if(e.hasOwnProperty("address")){var r=[];e.address.hasOwnProperty("streetAddress")&&r.push(e.address.streetAddress),e.address.hasOwnProperty("addressLocality")&&r.push(e.address.addressLocality),e.address.hasOwnProperty("postalCode")&&r.push(e.address.postalCode),e.address.hasOwnProperty("addressCountry")&&r.push(e.address.addressCountry),r.length&&(t=r.join(", "))}return t}(this.profile())},a.birthDate=function(){return function(e){if(!e)return null;var t=null;if(e.hasOwnProperty("birthDate")){var r=new Date(e.birthDate);t=["January","February","March","April","May","June","July","August","September","October","November","December"][r.getMonth()]+" "+r.getDate()+", "+r.getFullYear()}return t}(this.profile())},a.connections=function(){return function(e){if(!e)return null;var t=[];return e.hasOwnProperty("knows")&&(t=e.knows),t}(this.profile())},a.organizations=function(){return(e=this.profile())?e.hasOwnProperty("worksFor")?e.worksFor:[]:null;var e},n}(function(){function e(e){void 0===e&&(e={}),this._profile=Object.assign({},{"@context":"http://schema.org/"},e)}var t=e.prototype;return t.toJSON=function(){return Object.assign({},this._profile)},t.toToken=function(e){return Object(d.b)(this.toJSON(),e)},e.validateSchema=function(e,t){return void 0===t&&(t=!1),v.strict=t,Object(y.validate)(v,e)},e.fromToken=function(t,r){return void 0===r&&(r=null),new e(Object(d.a)(t,r))},e.makeZoneFile=function(e,t){return function(e,t){if(!t.includes("://"))throw new Error("Invalid token file url");var r=t.split("://")[0],n=t.split("://")[1].split("/"),a=n[0],i="/"+n.slice(1).join("/"),o={$origin:e,$ttl:3600,uri:[{name:"_http._tcp",priority:10,weight:1,target:r+"://"+a+i}]},s="{$origin}\n{$ttl}\n{uri}\n";return Object(g.makeZoneFile)(o,s)}(e,t)},e}());function w(e,t){return new Promise((function(r,n){var a=null;try{(a=Object(g.parseZoneFile)(e)).hasOwnProperty("$origin")||(a=null)}catch(s){n(s)}var i=null;if(a&&Object.keys(a).length>0)(i=function(e){if(!e.hasOwnProperty("uri"))return null;if(!Array.isArray(e.uri))return null;if(e.uri.length<1)return null;var t=e.uri[0];if(!t.hasOwnProperty("target"))return null;var r=t.target;return r.startsWith("https")||r.startsWith("http")||(r="https://"+r),r}(a))?Object(c.a)(i).then((function(e){return e.text()})).then((function(e){return JSON.parse(e)})).then((function(e){var n=e,a=Object(d.a)(n[0].token,t);r(a)})).catch((function(e){h.a.error("resolveZoneFileToProfile: error fetching token file "+i+": "+e),n(e)})):(h.a.debug("Token file url not found. Resolving to blank profile."),r({}));else{var o=null;try{o=JSON.parse(e),o=m.fromLegacyFormat(o).profile()}catch(u){n(u)}r(o)}}))}var x=r("C4i9");function k(e){if(!e.username)return Promise.reject();var t,r=e.network?e.network:new x.a;if(e.zoneFileLookupURL){var n=e.zoneFileLookupURL.replace(/\/$/,"")+"/"+e.username;t=Object(c.a)(n).then((function(e){return e.json()}))}else t=r.getNameInfo(e.username);return t.then((function(e){if(e.hasOwnProperty("zonefile")&&e.hasOwnProperty("address"))return w(e.zonefile,e.address);throw new Error("Invalid zonefile lookup response: did not contain `address` or `zonefile` field")}))}var O=r("Dj5/"),j=function(){function e(e){this.userSession=e.userSession}var t=e.prototype;return t.getFile=function(){var e=Object(n.a)(a.a.mark((function e(t,r){var n,i,o,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={decrypt:!0,verify:!1,app:Object(s.b)("location",{returnEmptyObject:!0}).origin},!(i=Object.assign({},n,r)).verify||i.decrypt){e.next=4;break}return e.abrupt("return",this.getFileSignedUnencrypted(t,i));case 4:return e.next=6,this.getFileContents(t,i.app,i.username,i.zoneFileLookupURL,!!i.decrypt);case 6:if(null!==(o=e.sent)){e.next=11;break}return e.abrupt("return",o);case 11:if(!i.decrypt||i.verify){e.next=22;break}if("string"===typeof o){e.next=14;break}throw new Error("Expected to get back a string for the cipherText");case 14:if("string"!==typeof i.decrypt){e.next=19;break}return c={privateKey:i.decrypt},e.abrupt("return",this.userSession.decryptContent(o,c));case 19:return e.abrupt("return",this.userSession.decryptContent(o));case 20:e.next=34;break;case 22:if(!i.decrypt||!i.verify){e.next=29;break}if("string"===typeof o){e.next=25;break}throw new Error("Expected to get back a string for the cipherText");case 25:return"string"===typeof i.decrypt&&(u=i.decrypt),e.abrupt("return",this.handleSignedEncryptedContents(t,o,i.app,u,i.username,i.zoneFileLookupURL));case 29:if(i.verify||i.decrypt){e.next=33;break}return e.abrupt("return",o);case 33:throw new Error("Should be unreachable.");case 34:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.getUserAppFileUrl=function(){var e=Object(n.a)(a.a.mark((function e(t,r,n,i){var o,s,c,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k({username:r,zoneFileLookupURL:i});case 2:return(o=e.sent).hasOwnProperty("apps")&&o.apps.hasOwnProperty(n)&&(c=o.apps[n],u=c.replace(/\/?(\?|#|$)/,"/$1"),s=""+u+t),e.abrupt("return",s);case 5:case"end":return e.stop()}}),e)})));return function(t,r,n,a){return e.apply(this,arguments)}}(),t.getGaiaAddress=function(){var e=Object(n.a)(a.a.mark((function e(t,r,n){var i,o,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=S(this.userSession,{app:t,username:r,zoneFileLookupURL:n}),!r){e.next=7;break}return e.next=4,this.getUserAppFileUrl("/",i.username,i.app,i.zoneFileLookupURL);case 4:o=e.sent,e.next=13;break;case 7:return e.next=9,this.getOrSetLocalGaiaHubConnection();case 9:return s=e.sent,e.next=12,Object(f.e)("/",s);case 12:o=e.sent;case 13:if(c=o.match(/([13][a-km-zA-HJ-NP-Z0-9]{26,35})/)){e.next=16;break}throw new Error("Failed to parse gaia address");case 16:return e.abrupt("return",c[c.length-1]);case 17:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}(),t.getFileUrl=function(){var e=Object(n.a)(a.a.mark((function e(t,r){var n,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=S(this.userSession,r)).username){e.next=7;break}return e.next=4,this.getUserAppFileUrl(t,n.username,n.app,n.zoneFileLookupURL);case 4:i=e.sent,e.next=13;break;case 7:return e.next=9,this.getOrSetLocalGaiaHubConnection();case 9:return o=e.sent,e.next=12,Object(f.e)(t,o);case 12:i=e.sent;case 13:if(i){e.next=17;break}throw new Error("Missing readURL");case 17:return e.abrupt("return",i);case 18:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}(),t.getFileContents=function(){var e=Object(n.a)(a.a.mark((function e(t,r,n,i,o){var s,u,p,l,h,d;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s={app:r,username:n,zoneFileLookupURL:i},e.next=3,this.getFileUrl(t,s);case 3:return u=e.sent,e.next=6,Object(c.a)(u);case 6:if((p=e.sent).ok){e.next=11;break}return e.next=10,Object(f.c)(p,"getFile "+t+" failed.",null);case 10:throw e.sent;case 11:if("string"===typeof(l=p.headers.get("Content-Type"))&&(l=l.toLowerCase()),(h=p.headers.get("ETag"))&&((d=this.userSession.store.getSessionData()).etags[t]=h,this.userSession.store.setSessionData(d)),!(o||null===l||l.startsWith("text")||l.startsWith("application/json"))){e.next=19;break}return e.abrupt("return",p.text());case 19:return e.abrupt("return",p.arrayBuffer());case 20:case"end":return e.stop()}}),e,this)})));return function(t,r,n,a,i){return e.apply(this,arguments)}}(),t.getFileSignedUnencrypted=function(){var e=Object(n.a)(a.a.mark((function e(t,r){var n,s,c,p,f,l,h,d,b;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t+".sig",e.prev=1,e.next=4,Promise.all([this.getFileContents(t,r.app,r.username,r.zoneFileLookupURL,!1),this.getFileContents(n,r.app,r.username,r.zoneFileLookupURL,!0),this.getGaiaAddress(r.app,r.username,r.zoneFileLookupURL)]);case 4:if(s=e.sent,c=s[0],p=s[1],f=s[2],c){e.next=10;break}return e.abrupt("return",c);case 10:if(f){e.next=12;break}throw new u.m("Failed to get gaia address for verification of: "+t);case 12:if(p&&"string"===typeof p){e.next=14;break}throw new u.m("Failed to obtain signature for file: "+t+" -- looked in "+t+".sig");case 14:e.prev=14,d=JSON.parse(p),l=d.signature,h=d.publicKey,e.next=27;break;case 20:if(e.prev=20,e.t0=e.catch(14),!(e.t0 instanceof SyntaxError)){e.next=26;break}throw new Error("Failed to parse signature content JSON (path: "+t+".sig) The content may be corrupted.");case 26:throw e.t0;case 27:if(b=Object(i.e)(h),f===b){e.next=32;break}throw new u.m("Signer pubkey address ("+b+") doesn't match gaia address ("+f+")");case 32:if(Object(o.e)(c,h,l)){e.next=36;break}throw new u.m("Contents do not match ECDSA signature: path: "+t+", signature: "+t+".sig");case 36:return e.abrupt("return",c);case 37:e.next=46;break;case 39:if(e.prev=39,e.t1=e.catch(1),!(e.t1 instanceof u.c&&e.t1.message.indexOf(n)>=0)){e.next=45;break}throw new u.m("Failed to obtain signature for file: "+t+" -- looked in "+t+".sig");case 45:throw e.t1;case 46:case"end":return e.stop()}}),e,this,[[1,39],[14,20]])})));return function(t,r){return e.apply(this,arguments)}}(),t.handleSignedEncryptedContents=function(){var e=Object(n.a)(a.a.mark((function e(t,r,n,s,c,p){var f,l,h,d,b,g,y,v,m;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f=s||this.userSession.loadUserData().appPrivateKey,l=Object(i.b)(f),!c){e.next=8;break}return e.next=5,this.getGaiaAddress(n,c,p);case 5:h=e.sent,e.next=9;break;case 8:h=Object(i.e)(l);case 9:if(h){e.next=11;break}throw new u.m("Failed to get gaia address for verification of: "+t);case 11:e.prev=11,d=JSON.parse(r),e.next=22;break;case 15:if(e.prev=15,e.t0=e.catch(11),!(e.t0 instanceof SyntaxError)){e.next=21;break}throw new Error("Failed to parse encrypted, signed content JSON. The content may not be encrypted. If using getFile, try passing { verify: false, decrypt: false }.");case 21:throw e.t0;case 22:if(b=d.signature,g=d.publicKey,y=d.cipherText,v=Object(i.e)(g),g&&y&&b){e.next=30;break}throw new u.m("Failed to get signature verification data from file: "+t);case 30:if(v===h){e.next=34;break}throw new u.m("Signer pubkey address ("+v+") doesn't match gaia address ("+h+")");case 34:if(Object(o.e)(y,g,b)){e.next=38;break}throw new u.m("Contents do not match ECDSA signature in file: "+t);case 38:if("string"!==typeof s){e.next=43;break}return m={privateKey:s},e.abrupt("return",this.userSession.decryptContent(y,m));case 43:return e.abrupt("return",this.userSession.decryptContent(y));case 44:case"end":return e.stop()}}),e,this,[[11,15]])})));return function(t,r,n,a,i,o){return e.apply(this,arguments)}}(),t.putFile=function(){var e=Object(n.a)(a.a.mark((function e(t,r,c){var p,h,d,b,g,y,v,m,w,x,k,O,j,S,E,F,_,C,T,N,U,A,P,D,z=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p={encrypt:!0,sign:!1,cipherTextEncoding:"hex"},h=Object.assign({},p,c),e.next=4,this.getOrSetLocalGaiaHubConnection();case 4:if(d=e.sent,b=Object(s.f)(d.max_file_upload_size_megabytes),g=b>0,y=new l.a(r,h.contentType),v=y.contentType,!(!h.encrypt&&g&&y.contentByteLength>b)){e.next=14;break}throw m="The max file upload size for this hub is "+b+" bytes, the given content is "+y.contentByteLength+" bytes",w=new u.k(m,null,b),console.error(w),w;case 14:if(!h.encrypt||!g){e.next=21;break}if(!((x=Object(o.b)({contentLength:y.contentByteLength,wasString:y.wasString,sign:!!h.sign,cipherTextEncoding:h.cipherTextEncoding}))>b)){e.next=21;break}throw k="The max file upload size for this hub is "+b+" bytes, the given content is "+x+" bytes after encryption",O=new u.k(k,null,b),console.error(O),O;case 21:if(S=!0,(E=this.userSession.store.getSessionData()).etags[t]&&(S=!1,j=E.etags[t]),h.encrypt||!h.sign){e.next=34;break}return e.next=27,y.load();case 27:_=e.sent,C="string"===typeof h.sign?h.sign:this.userSession.loadUserData().appPrivateKey,T=Object(o.d)(C,_),N=JSON.stringify(T),F=function(){var e=Object(n.a)(a.a.mark((function e(r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([Object(f.f)(t,_,r,v,S,j),Object(f.f)(t+".sig",N,r,"application/json")]);case 2:return(n=e.sent[0]).etag&&(E.etags[t]=n.etag,z.userSession.store.setSessionData(E)),e.abrupt("return",n.publicURL);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),e.next=47;break;case 34:if(h.encrypt||h.sign){e.next=38;break}U=y.content,e.next=46;break;case 38:return A="string"===typeof h.encrypt?h.encrypt:"string"===typeof h.sign?Object(i.b)(h.sign):Object(i.b)(this.userSession.loadUserData().appPrivateKey),e.next=41,y.load();case 41:return P=e.sent,e.next=44,this.userSession.encryptContent(P,{publicKey:A,wasString:y.wasString,cipherTextEncoding:h.cipherTextEncoding,sign:h.sign});case 44:U=e.sent,v="application/json";case 46:F=function(){var e=Object(n.a)(a.a.mark((function e(r){var n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.f)(t,U,r,v,S,j);case 2:return(n=e.sent).etag&&(E.etags[t]=n.etag,z.userSession.store.setSessionData(E)),e.abrupt("return",n.publicURL);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();case 47:return e.prev=47,e.next=50,F(d);case 50:return e.abrupt("return",e.sent);case 53:if(e.prev=53,e.t0=e.catch(47),!L(e.t0)){e.next=66;break}return console.error(e.t0),console.error("Possible recoverable error during Gaia upload, retrying..."),e.next=60,this.setLocalGaiaHubConnection();case 60:return D=e.sent,e.next=63,F(D);case 63:return e.abrupt("return",e.sent);case 66:throw e.t0;case 67:case"end":return e.stop()}}),e,this,[[47,53]])})));return function(t,r,n){return e.apply(this,arguments)}}(),t.deleteFile=function(){var e=Object(n.a)(a.a.mark((function e(t,r){var n,i,o,s,c;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrSetLocalGaiaHubConnection();case 2:if(n=e.sent,i=Object.assign({},r),o=this.userSession.store.getSessionData(),!i.wasSigned){e.next=28;break}return e.prev=6,e.next=9,Object(f.b)(t,n);case 9:return e.next=11,Object(f.b)(t+".sig",n);case 11:delete o.etags[t],this.userSession.store.setSessionData(o),e.next=26;break;case 15:return e.prev=15,e.t0=e.catch(6),e.next=19,this.setLocalGaiaHubConnection();case 19:return s=e.sent,e.next=22,Object(f.b)(t,s);case 22:return e.next=24,Object(f.b)(t+".sig",n);case 24:delete o.etags[t],this.userSession.store.setSessionData(o);case 26:e.next=44;break;case 28:return e.prev=28,e.next=31,Object(f.b)(t,n);case 31:delete o.etags[t],this.userSession.store.setSessionData(o),e.next=44;break;case 35:return e.prev=35,e.t1=e.catch(28),e.next=39,this.setLocalGaiaHubConnection();case 39:return c=e.sent,e.next=42,Object(f.b)(t,c);case 42:delete o.etags[t],this.userSession.store.setSessionData(o);case 44:case"end":return e.stop()}}),e,this,[[6,15],[28,35]])})));return function(t,r){return e.apply(this,arguments)}}(),t.getAppBucketUrl=function(e,t){return Object(f.d)(e,t)},t.listFilesLoop=function(){var e=Object(n.a)(a.a.mark((function e(t,r,n,i,o){var s,u,p,l,h,d,b,g,y,v;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n>65536)){e.next=2;break}throw new Error("Too many entries to list");case 2:if(e.t0=t,e.t0){e.next=7;break}return e.next=6,this.getOrSetLocalGaiaHubConnection();case 6:e.t0=e.sent;case 7:return t=e.t0,e.prev=8,u=JSON.stringify({page:r}),p={method:"POST",headers:{"Content-Type":"application/json","Content-Length":""+u.length,Authorization:"bearer "+t.token},body:u},e.next=13,Object(c.a)(t.server+"/list-files/"+t.address,p);case 13:if((s=e.sent).ok){e.next=18;break}return e.next=17,Object(f.c)(s,"ListFiles failed.",t);case 17:throw e.sent;case 18:e.next=28;break;case 20:if(e.prev=20,e.t1=e.catch(8),0!==n){e.next=27;break}return e.next=25,this.setLocalGaiaHubConnection();case 25:return l=e.sent,e.abrupt("return",this.listFilesLoop(l,r,n+1,0,o));case 27:throw e.t1;case 28:return e.next=30,s.text();case 30:if(h=e.sent,d=JSON.parse(h),b=d.entries,g=d.page,null!==b&&void 0!==b){e.next=36;break}throw new Error("Bad listFiles response: no entries");case 36:y=0,v=0;case 38:if(!(v<b.length)){e.next=47;break}if(null===b[v]){e.next=44;break}if(y++,o(b[v])){e.next=44;break}return e.abrupt("return",i+v);case 44:v++,e.next=38;break;case 47:if(!(g&&b.length>0)){e.next=51;break}return e.abrupt("return",this.listFilesLoop(t,g,n+1,i+y,o));case 51:return e.abrupt("return",i+y);case 52:case"end":return e.stop()}}),e,this,[[8,20]])})));return function(t,r,n,a,i){return e.apply(this,arguments)}}(),t.listFiles=function(e){return this.listFilesLoop(null,null,0,0,e)},t.getOrSetLocalGaiaHubConnection=function(){var e=Object(n.a)(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.userSession.store.getSessionData(),r=t.userData){e.next=4;break}throw new u.f("Missing userData");case 4:if(!(n=r.gaiaHubConfig)){e.next=7;break}return e.abrupt("return",Promise.resolve(n));case 7:return e.abrupt("return",this.setLocalGaiaHubConnection());case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),t.setLocalGaiaHubConnection=function(){var e=Object(n.a)(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.userSession.loadUserData()){e.next=3;break}throw new u.f("Missing userData");case 3:return t.hubUrl||(t.hubUrl=p.a),e.next=6,Object(f.a)(t.hubUrl,t.appPrivateKey,t.gaiaAssociationToken);case 6:return r=e.sent,t.gaiaHubConfig=r,(n=this.userSession.store.getSessionData()).userData.gaiaHubConfig=r,this.userSession.store.setSessionData(n),e.abrupt("return",r);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),e}();function S(e,t){var r=Object.assign({},t);if(r.username){if(!r.app){if(!e.appConfig)throw new u.f("Missing AppConfig");r.app=e.appConfig.appDomain}if(!r.zoneFileLookupURL){if(!e.appConfig)throw new u.f("Missing AppConfig");if(!e.store)throw new u.f("Missing store UserSession");var n=e.store.getSessionData().userData.coreNode||e.appConfig.coreNode;n&&(r.zoneFileLookupURL=""+n+O.e)}}return r}function L(e){if(!e||!e.hubError||!e.hubError.statusCode)return!1;var t=e.hubError.statusCode;return 401===t||(409===t||t>=500&&t<=599)}},TT5w:function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));var n=r("rePB"),a=r("q1tI"),i=r.n(a),o=r("TSYQ"),s=r.n(o),c=r("R/WZ"),u=r("eDSW"),p={infoArea:{maxWidth:"360px",margin:"0 auto",padding:"0px"},iconWrapper:{float:"left",marginTop:"24px",marginRight:"10px"},primary:{color:u.p},warning:{color:u.z},danger:{color:u.f},success:{color:u.u},info:{color:u.m},rose:{color:u.r},gray:{color:u.i},icon:{width:"36px",height:"36px"},descriptionWrapper:{color:u.i,overflow:"hidden"},title:u.v,description:{color:u.i,overflow:"hidden",marginTop:"0px",fontSize:"14px"},iconWrapperVertical:{float:"none"},iconVertical:{width:"61px",height:"61px"}},f=i.a.createElement,l=Object(c.a)(p);function h(e){var t,r,a=l(),i=e.title,o=e.description,c=e.iconColor,u=e.vertical,p=s()((t={},Object(n.a)(t,a.iconWrapper,!0),Object(n.a)(t,a[c],!0),Object(n.a)(t,a.iconWrapperVertical,u),t)),h=s()((r={},Object(n.a)(r,a.icon,!0),Object(n.a)(r,a.iconVertical,u),r));return f("div",{className:a.infoArea},f("div",{className:p},f(e.icon,{className:h})),f("div",{className:a.descriptionWrapper},f("h4",{className:a.title},i),f("p",{className:a.description},o)))}h.defaultProps={iconColor:"gray"}},ghzz:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return i}));var n=r("ldnW"),a=r("mXOV"),i=function(){function t(e,r){this.wasString="string"===typeof e,this.content=t.normalizeContentDataType(e,r),this.contentType=r||this.detectContentType(),this.contentByteLength=this.detectContentLength()}t.normalizeContentDataType=function(t,r){try{if("string"===typeof t){var n=(r||"").toLowerCase().replace("-","");if(n.includes("charset")&&!n.includes("charset=utf8")&&!n.includes("charset=ascii"))throw new Error("Unable to determine byte length with charset: "+r);if("undefined"!==typeof TextEncoder){var a=(new TextEncoder).encode(t);return e.from(a.buffer)}return e.from(t)}if(e.isBuffer(t))return t;if(ArrayBuffer.isView(t))return e.from(t.buffer,t.byteOffset,t.byteLength);if("undefined"!==typeof Blob&&t instanceof Blob)return t;if("undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer)return e.from(t);if(Array.isArray(t)){if(t.length>0&&(!Number.isInteger(t[0])||t[0]<0||t[0]>255))throw new Error('Unexpected array values provided as file data: value "'+t[0]+'" at index 0 is not an octet number. '+this.supportedTypesMsg);return e.from(t)}var i=Object.prototype.toString.call(t);throw new Error("Unexpected type provided as file data: "+i+". "+this.supportedTypesMsg)}catch(o){throw console.error(o),new Error("Error processing data: "+o)}};var r=t.prototype;return r.detectContentType=function(){return this.wasString?"text/plain; charset=utf-8":"undefined"!==typeof Blob&&this.content instanceof Blob&&this.content.type?this.content.type:"application/octet-stream"},r.detectContentLength=function(){if(ArrayBuffer.isView(this.content)||e.isBuffer(this.content))return this.content.byteLength;if("undefined"!==typeof Blob&&this.content instanceof Blob)return this.content.size;var t=Object.prototype.toString.call(this.content),r=new Error('Unexpected type "'+t+'" while detecting content length');throw console.error(r),r},r.loadContent=function(){var t=Object(n.a)(a.a.mark((function t(){var r,n,i,o,s,c=this;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.isBuffer(this.content)){t.next=5;break}return t.abrupt("return",this.content);case 5:if(!ArrayBuffer.isView(this.content)){t.next=9;break}return t.abrupt("return",e.from(this.content.buffer,this.content.byteOffset,this.content.byteLength));case 9:if(!("undefined"!==typeof Blob&&this.content instanceof Blob)){t.next=18;break}return r=new FileReader,n=new Promise((function(t,n){r.onerror=function(e){n(e)},r.onload=function(){var n=r.result;t(e.from(n))},r.readAsArrayBuffer(c.content)})),t.next=14,n;case 14:return i=t.sent,t.abrupt("return",i);case 18:throw o=Object.prototype.toString.call(this.content),new Error("Unexpected type "+o);case 20:t.next=28;break;case 22:throw t.prev=22,t.t0=t.catch(0),console.error(t.t0),s=new Error("Error loading content: "+t.t0),console.error(s),s;case 28:case"end":return t.stop()}}),t,this,[[0,22]])})));return function(){return t.apply(this,arguments)}}(),r.load=function(){return void 0===this.loadedData&&(this.loadedData=this.loadContent()),this.loadedData},t}();i.supportedTypesMsg="Supported types are: `string` (to be UTF8 encoded), `Buffer`, `Blob`, `File`, `ArrayBuffer`, `UInt8Array` or any other typed array buffer. "}).call(this,r("tjlA").Buffer)},ldnW:function(e,t,r){"use strict";function n(e,t,r,n,a,i,o){try{var s=e[i](o),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,a)}function a(e){return function(){var t=this,r=arguments;return new Promise((function(a,i){var o=e.apply(t,r);function s(e){n(o,a,i,s,c,"next",e)}function c(e){n(o,a,i,s,c,"throw",e)}s(void 0)}))}}r.d(t,"a",(function(){return a}))},mXOV:function(e,t,r){"use strict";function n(e,t){return e(t={exports:{}},t.exports),t.exports}var a=n((function(e){var t=function(e){var t=Object.prototype,r=t.hasOwnProperty,n="function"===typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function s(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(L){s=function(e,t,r){return e[t]=r}}function c(e,t,r,n){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),o=new O(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(a,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===a)throw i;return S()}for(r.method=a,r.arg=i;;){var o=r.delegate;if(o){var s=w(o,r);if(s){if(s===p)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=u(e,t,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}(e,r,o),i}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(L){return{type:"throw",arg:L}}}e.wrap=c;var p={};function f(){}function l(){}function h(){}var d={};d[a]=function(){return this};var b=Object.getPrototypeOf,g=b&&b(b(j([])));g&&g!==t&&r.call(g,a)&&(d=g);var y=h.prototype=f.prototype=Object.create(d);function v(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function m(e,t){var n;this._invoke=function(a,i){function o(){return new t((function(n,o){!function n(a,i,o,s){var c=u(e[a],e,i);if("throw"!==c.type){var p=c.arg,f=p.value;return f&&"object"===typeof f&&r.call(f,"__await")?t.resolve(f.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(f).then((function(e){p.value=e,o(p)}),(function(e){return n("throw",e,o,s)}))}s(c.arg)}(a,i,n,o)}))}return n=n?n.then(o,o):o()}}function w(e,t){var r=e.iterator[t.method];if(undefined===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=undefined,w(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var n=u(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,p;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=undefined),t.delegate=null,p):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function j(e){if(e){var t=e[a];if(t)return t.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=undefined,t.done=!0,t};return i.next=i}}return{next:S}}function S(){return{value:undefined,done:!0}}return l.prototype=y.constructor=h,h.constructor=l,l.displayName=s(h,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===l||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,o,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},v(m.prototype),m.prototype[i]=function(){return this},e.AsyncIterator=m,e.async=function(t,r,n,a,i){void 0===i&&(i=Promise);var o=new m(c(t,r,n,a),i);return e.isGeneratorFunction(r)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},v(y),s(y,o,"Generator"),y[a]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=j,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=undefined,this.done=!1,this.delegate=null,this.method="next",this.arg=undefined,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=undefined)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return o.type="throw",o.arg=e,t.next=r,n&&(t.method="next",t.arg=undefined),!!n}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(s&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),k(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;k(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:j(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=undefined),p}},e}(e.exports);try{regeneratorRuntime=t}catch(r){Function("r","regeneratorRuntime = r")(t)}}));t.a=a}}]);